<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19051" />

<meta name="date" content="2020-01-03" />

<title>Homework of SC19051</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework of SC19051</h1>
<h4 class="author">19051</h4>
<h4 class="date">2020-01-03</h4>



<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="assignment" class="section level2">
<h2>Assignment</h2>
<p>Exercises 3.4, 3.11, and 3.18 (pages 94-96, Statistical Computating with R).</p>
<hr />
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="exercise-3.4" class="section level3">
<h3>Exercise 3.4:</h3>
<p><span class="math inline">\(Sol.\)</span> Since the Rayleigh density is <span class="math display">\[
f(x)= \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)},\quad x\ge0,σ&gt;0. 
\]</span> we can obtain its cumulative density function by integral, which is <span class="math display">\[
F_X (x) = 1- e^{−x^2/(2\sigma^2)},\quad x\ge0,σ&gt;0.
\]</span> Then the inverse function will be <span class="math display">\[
F_X^{-1}(u) = \sigma\sqrt{-2\log (1-u)},\quad u\in (0,1)
\]</span> Now we can apply the inverse transform method by randomly generating <span class="math inline">\(u\sim U(0,1)\)</span> and transforming it into <span class="math inline">\(F_X^{-1}(u)\)</span>, which follows a Rayleigh<span class="math inline">\((σ)\)</span> distribution as we expect.In the following figures, the theoretical mode <span class="math inline">\(σ\)</span> is marked by blue vertical lines.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">graph_hist =<span class="st"> </span><span class="cf">function</span>(size, sigma){</a>
<a class="sourceLine" id="cb1-3" title="3">  </a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="kw">hist</span>(<span class="dt">x =</span> sigma <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="kw">runif</span>(size))), <span class="dt">prob =</span> T,<span class="dt">main=</span><span class="st">&quot;Sample from Rayleigh Distribution&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;value&quot;</span>) <span class="co">#histogram of the sample points </span></a>
<a class="sourceLine" id="cb1-5" title="5">  </a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="kw">abline</span>(<span class="dt">v =</span> sigma,<span class="dt">lwd=</span><span class="dv">4</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co">#the position of mode</span></a>
<a class="sourceLine" id="cb1-7" title="7">}</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">graph_hist</span>(<span class="dv">10000</span>,<span class="fl">0.5</span>)         <span class="co"># Histogram when sigma = 0.5</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">graph_hist</span>(<span class="dv">10000</span>,<span class="dv">1</span>)        <span class="co"># Histogram when sigma = 1</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">graph_hist</span>(<span class="dv">10000</span>,<span class="dv">5</span>)       <span class="co"># Histogram when sigma = 5</span></a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/9vb////tmb/25D/27b//7b//9v///8WWvgVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALLUlEQVR4nO2da2PixhmFhbe40LppEojTpLG7aTdB20vWrZXdbZEN+v9/qnPVDc2cERIgpHM+2CCGd2Ye3rmPRlFGeRVdOgFDFwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBWUD7f95F0ezLpxZf3T9Gt9vDq++XUfRVGyNKsy+cUdfjOYw3iWab2gVtVOXnMPz+7881a3F085w1aR/V0vkQkClnQqVSaWbVxohRLY/ueMIB6fwchH+9vwkF9Hof1Sw6QIYk3JFYaMRq0Soeb5x5dhoT00DDBSiOIvti9oPgJVIrXejTvTD9hTC9W0eLT3fys1+X0XyjLf3ybRTNn/KE79+LZHy1LSzKVIkk/+0+uhGhPonQv/lu22SrnPuXpfpvYxaXFS/hjw/1eErv5xuVMxHbz+pdAUjl9/O9xG7C/2rrkFg7gkniB+tBMluqSGpYIrkrFbRCUCRzZUqJgi9Cad1Z74qLX0ZHbILMn2uApMTH5rcsApZsVdwjlv+LmE0WZbrq8ej32vVmdxpQzf3Nt+WXbrc6fJIHyQGphP3PACosNAISoWfffcjT/NutZiVTtco+imA/yCArBUD4xcfil4nlew225O4i8O1T9l/jGOqrh7YOPKgUs/jzoL3uIB79XrBcbPdxZACJ2AqjOSD1QoWXlrYy9pUlYJJorcs3KltlQEURM1XB/J0pKp9lo7bQv4D5qyHEuhDGpYhX5RQVgB5Knin/HdoqRVzU7CZmXcZkCcvq8ZSrVXFZA3qwWaoDmm1UeBHj/ENeDRhAD1lRSc829pNGQFn28S4vKvu3ttZUv6D5awGpqMsRV2tDC0i9t/4h3x7aqgJabMsx6zzGpjBV4lHvrWVbB22saQcgHY+qDHNApSSWsuUCJIJ+/nFpfrxo/tfPax+gvPJM681FBZBNswzuBzR/Z96YmFUZ04msx5MXmdwbAgDJBlt9/ScHoPyHNB/nBUbZyRMsP9Rvdl5AZQ+qdp3ae5D4ef+hqvGsFLMqY9pKPZ4WHiRC2SIp2ugf73RzEeRBVUDC9ux72couxYeq4OeV9AGggzqo2n+pAKrVQS5AqkKwVY79MJFN1K1t1kvxNNVBzYBktyVv5tVX/1JUMjVAebbMB2lUKWJFz2qhGxRtuxFQvRUTPZvXdZ6GKqBqK+YGpFNYilmF0RV3PZ6mVuwAUKnk2yL6tSpnKjkHTl7Klk6tTMVKva5WBTK6/LUDUClc0T/Je6xVQNV+kAfQy1L7ZF5Jq2QoP6jH09QPcgEqhhrvi6oyjUxHsQIo7wfl7YHuElq/Va2YruVlWzJ/lzQWC+GE/3mru5wmb69vl6YL2gRI96S/zzIASCZxUYo5U4lblILk8ZR60n98ctVBmkZ5sKoyqIbEqg/+VK+D8p509iLq8y9/0Q3E+7bTHc5hb/9KowgPnWM0Tuuq4QIS9YUvqlhNqghXdI1xe9JQAakqxzdrYjtGreYOjtCAAc2+9oZ4/XbZdorvGHHKFYiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIDaAZLLKWqlITnb2sal1QpQovZUyWUEAmrS/lGvBMvVWwJq0G6tF/Li2y0BNUl7kFC8IKBGWSx608k01LYV04Vs/0hAlBYBAV0K0Js3by4Uc0tdCNCbUQLKbyaIWt300qRxAuqx8RopIEGo+34u5YASkHbFzvZOrJYJTJu3DRZFLzDG3IPGBqgHcwQUEoSAQJDRA3KN5gmouzkCCglCQCDIWAHZ23GcHeqJA0rszQGp6y6BaQPK56QFKsc9NtMGZFc1hNLemvmqWqTmTBqWB105oHzO/mR10LUDyqfMnHf5TR1QH+YIKCTI1AD1NWE2WkBtzBFQSBACqlw87AwSkPsiAYGLBAQuEhC4eK2ADk5K6mbOffFaAelN0OFnjEJzrovXCyjrgdHYAWlEHbZwjBxQGumDHY8/s2jMgORcjybjmk9tZc558VoB7dZ9HFU0ZkDfaD4d3CebBKBuNxmMFlBcDLaPaeb9E2ZjAFR4UE/m3BevFdAJzU0IUCwqKHmSp7PBGyug3XqV7xL3VNKKz+82lUXoJnPei1cJKEwCo7yZTr5stfQ8IUAPdn2+1eaFkQCS/pF4VpUz7T3JZD0olueiL0wRatZuLc98lscsu2rpEQOS5UfeaOAfapgjZp0QRw5ItlKXHWoMbz9VqYgtdmt5uH6nmel+PWhYgOQBxRtwv9Nxu1xHAihAR+5ynQygY/cojgQQLD5H73IdCaAYNl/T9iA10AJy7nI90YTZwAAFPP/xuF2u4wDUxw3NowbkuqH5WHPOi9cKKGTCrFCrWzLHAeiE5ggImBsLIPUAy7jbDqExA0pnm0SO5n2EpjxYld3kBJyQOOnBquwoSkCeGcVpDzWsB8XuWfuJD1Z1HZR4uovT9iDTVfTuojrylsyxAArQlAerJzQ3DkDaObo+k3O8gGJz0vhx+8hPNWE2gFUyE2u+lvyy7DTpcUoPuiSg0myZb20+1Jx3gfQqAZVGYH0sPeN8Xh8g2EduY46AgDkCAuYICJgbI6CiySGgU8ZKQEHmCAiYIyBgjoCAOQIC5ggImCMgYI6ADqxUZzYICJgjIGDuRIAuMgHbLp7AzQvn8KBBAgrdvDBVQMFLz1MFFLx5YaqA6EFIoZsXJgsodPPCdAEFmiMgYG66gIbUUTxTv3okHcVhABpwMz8MQAPuKA4D0JA96GQ1Uj8dxfqEGZQEhEOdRicEhDuKoco9aPA6V3eiJgICGj2gbhv1JgAIGIU6byXdKS99QWlrtKcwfUV1mi93MTpOQPgAlGCjowSEB6vhRscIKGCoEW50jICC98JOFRA9CAmvaoQbHSWg0MHqdAFNUAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQP0DSsExVpmdFPAeEvLy+2dkTAfx2FIz6KvANLnUOyB5jozzuSRG6gFKXslHnABjJojb1v5RfDOR7ELS5FLfgPSsIzhCBh5ekOqFE58xE8RjS5/0k5iHyRx7rE3fgPJU+QIlIK1ptFL59hizQbCt2SYoTS71Dkh5PHCR+A8RepaiBuQ1pq8jW/HNc1CaXOobkC7q/gIvnwAjUu4lpLLjN6aCIFty9jwkTU5dApAJ6X/KUiAgYCu1dfRgAIW7s/+0tOAi5rWlV18GVcTCK0R/W48q6awKqNmWWSofVCUd0qTqBAcUMb+xEsNmW3YZb1DNfFCnTKU1oJL2GzOtmNPWy9JeHVJHUf5uuFsvn5zsP6/R+ITPmAnitJXoRU75/ZA0OcTBKhABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0PABle7Wv4QICIiAgAYHyOyImm3svhYBSDFSfxK4PbZvDQ6QfqJpfLuVO6MSwakMSL4v9kWdRYMDpPYS7tar3Tcb7U4lQPppp90eMthWwwMkaZj9cqksYyVA+nLHhwm31PAAyV2HooTJ6ubmX1UPSs2hbRMHlN78WwBRflIrYsduxOyiAQLarf8kahm91d4WsZWCdYkWf4CARPu+sM4j2nRBZf94u90/RroVy+Kz+tEQAaWqklFbdwUM6TbytsI/237QWRuxQQIalAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOj/QUVIBRQszroAAAAASUVORK5CYII=" /><!-- --></p>
<hr />
</div>
<div id="exercise-3.11" class="section level3">
<h3>Exercise 3.11</h3>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">set.seed</span>(<span class="dv">54321</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3">ge_MN =<span class="st"> </span><span class="cf">function</span>(n, p1){  <span class="co"># sample of mixture normal</span></a>
<a class="sourceLine" id="cb4-4" title="4">    U =<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb4-5" title="5">    Y =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb4-7" title="7">      <span class="cf">if</span>(U[i] <span class="op">&lt;=</span><span class="st"> </span>p1){</a>
<a class="sourceLine" id="cb4-8" title="8">        Y[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-9" title="9">      }</a>
<a class="sourceLine" id="cb4-10" title="10">      <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb4-11" title="11">        Y[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb4-12" title="12">      }</a>
<a class="sourceLine" id="cb4-13" title="13">    }</a>
<a class="sourceLine" id="cb4-14" title="14">    </a>
<a class="sourceLine" id="cb4-15" title="15">    <span class="kw">hist</span>(Y, <span class="dt">probability =</span> T, <span class="dt">main =</span> <span class="st">&quot;Mixture Normal&quot;</span>)</a>
<a class="sourceLine" id="cb4-16" title="16">    count =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb4-17" title="17">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb4-18" title="18">      <span class="cf">if</span>(Y[i] <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.5</span>){</a>
<a class="sourceLine" id="cb4-19" title="19">        count =<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-20" title="20">      }</a>
<a class="sourceLine" id="cb4-21" title="21">    }</a>
<a class="sourceLine" id="cb4-22" title="22">    <span class="kw">print</span>(<span class="st">&quot;The conjecture about p1 is &quot;</span>)</a>
<a class="sourceLine" id="cb4-23" title="23">    <span class="kw">print</span>(count<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb4-24" title="24">}</a>
<a class="sourceLine" id="cb4-25" title="25"></a>
<a class="sourceLine" id="cb4-26" title="26"></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="kw">ge_MN</span>(<span class="dv">5000</span>, <span class="fl">0.25</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] &quot;The conjecture about p1 is &quot;
## [1] 0.2896</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">ge_MN</span>(<span class="dv">5000</span>, <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] &quot;The conjecture about p1 is &quot;
## [1] 0.495</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">ge_MN</span>(<span class="dv">5000</span>, <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] &quot;The conjecture about p1 is &quot;
## [1] 0.7192</code></pre>
<hr />
</div>
<div id="exercise-3.18" class="section level3">
<h3>Exercise 3.18:</h3>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">library</span>(matrixcalc)</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3">ge_Wishart =<span class="st"> </span><span class="cf">function</span>(n, Sigma){</a>
<a class="sourceLine" id="cb10-4" title="4">  n =<span class="st"> </span><span class="kw">as.integer</span>(n)</a>
<a class="sourceLine" id="cb10-5" title="5">  d =<span class="st"> </span><span class="kw">nrow</span>(Sigma)</a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="cf">if</span>(n <span class="op">&lt;=</span><span class="st"> </span>d<span class="op">+</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb10-7" title="7">    <span class="kw">return</span>(<span class="st">&quot;error in dimension&quot;</span>)</a>
<a class="sourceLine" id="cb10-8" title="8">  }</a>
<a class="sourceLine" id="cb10-9" title="9">  </a>
<a class="sourceLine" id="cb10-10" title="10">  UL =<span class="st"> </span><span class="kw">chol</span>(Sigma)                  </a>
<a class="sourceLine" id="cb10-11" title="11">  <span class="co"># Choleski factorization, where UL is upper triangular</span></a>
<a class="sourceLine" id="cb10-12" title="12">  </a>
<a class="sourceLine" id="cb10-13" title="13">  MA =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb10-14" title="14">  </a>
<a class="sourceLine" id="cb10-15" title="15">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb10-16" title="16">    MA[i,i] =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>, n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-17" title="17">    <span class="cf">if</span>(i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb10-18" title="18">      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(i<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb10-19" title="19">        MA[i,j] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-20" title="20">      } </a>
<a class="sourceLine" id="cb10-21" title="21">    }</a>
<a class="sourceLine" id="cb10-22" title="22">  }</a>
<a class="sourceLine" id="cb10-23" title="23">  </a>
<a class="sourceLine" id="cb10-24" title="24">  <span class="kw">return</span>(<span class="kw">t</span>(UL) <span class="op">%*%</span><span class="st"> </span>MA <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(MA) <span class="op">%*%</span><span class="st"> </span>UL)</a>
<a class="sourceLine" id="cb10-25" title="25">}</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">B =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">0</span>),<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="op">-</span><span class="dv">6</span>),<span class="kw">c</span>(<span class="dv">0</span>,<span class="op">-</span><span class="dv">6</span>,<span class="dv">11</span>))</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">ge_Wishart</span>(<span class="dv">5</span>,B)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]
## [1,]  28.10198  22.86565 -31.49837
## [2,]  22.86565  25.59596 -30.80540
## [3,] -31.49837 -30.80540  45.62919</code></pre>
<hr />
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.10, 5.15 (pages 149-151, Statistical Computating with R).</p>
<hr />
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="exercise-5.1" class="section level3">
<h3>Exercise 5.1</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[
\int_{0}^{\pi/3} sint\ dt 
\]</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math inline">\(sol.\)</span>We can apply the vanilla Monte Carlo here.First,we can sample <span class="math inline">\(X_{1},...,X_{N}\ i.i.d\sim\ U(0,\pi/3)\)</span>.Then compute <span class="math display">\[
\frac{\pi}{3}*\frac{1}{N}\sum_{i=1}^{N}X_{i}
\]</span> to obtain the estimate of the integral.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">N =<span class="st"> </span><span class="dv">10000</span> <span class="co">##size of Monte Carlo sample</span></a>
<a class="sourceLine" id="cb13-2" title="2">est_Mon =<span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">mean</span>(<span class="kw">runif</span>(N,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb13-3" title="3">true_value =<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(t){<span class="kw">sin</span>(t)},<span class="dt">lower =</span> <span class="dv">0</span>,<span class="dt">upper =</span> pi<span class="op">/</span><span class="dv">3</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The Monte Carlo estimate is&quot;</span>,<span class="kw">round</span>(est_Mon,<span class="dv">3</span>),<span class="st">&quot;and the true value of the integral is&quot;</span>,true_value))</a></code></pre></div>
<pre><code>## [1] &quot;The Monte Carlo estimate is 0.552 and the true value of the integral is 0.5&quot;</code></pre>
<hr />
</div>
<div id="exercise-5.10" class="section level3">
<h3>Exercise 5.10</h3>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[
\int_{0}^{1}\frac{e^{-x}}{1+x^2}\ dx
\]</span> and ﬁnd the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<p><span class="math inline">\(sol.\)</span>First,we can sample <span class="math inline">\(U_{1},...,U_{2N}\ i.i.d\sim\ U(0,1)\)</span>.Then, we can compute the Monte Carlo estimate: <span class="math display">\[
\frac{1}{2N}\sum_{i=1}^{2N}\frac{e^{-X_{i}}}{1+X_{i}^2}
\]</span> To compare the vanilla Monte Carlo and antithetic Monte Carlo, we denote the sum above by <span class="math inline">\(F(X_1,...,X_2N)\)</span> and compute <span class="math inline">\(F(U_1,...U_2N)\)</span> and <span class="math inline">\(F(U_1,...U_N,1-U_{N+1},...1-U_{2N})\)</span> respectively.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">f =<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb15-3" title="3">}  <span class="co">##define the function f</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5">U1 =<span class="st"> </span><span class="kw">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-6" title="6">U2 =<span class="st"> </span><span class="kw">runif</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb15-7" title="7">est_van =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="kw">f</span>(U1),<span class="kw">f</span>(U2)))</a>
<a class="sourceLine" id="cb15-8" title="8">est_ant =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(<span class="kw">f</span>(U1),<span class="kw">f</span>(<span class="dv">1</span><span class="op">-</span>U2)))</a>
<a class="sourceLine" id="cb15-9" title="9">var_van =<span class="st"> </span><span class="kw">var</span>(<span class="kw">c</span>(<span class="kw">f</span>(U1),<span class="kw">f</span>(U2)))</a>
<a class="sourceLine" id="cb15-10" title="10">var_ant =<span class="st"> </span><span class="kw">var</span>(<span class="kw">c</span>(<span class="kw">f</span>(U1),<span class="kw">f</span>(<span class="dv">1</span><span class="op">-</span>U2)))</a>
<a class="sourceLine" id="cb15-11" title="11">reduction =<span class="st"> </span>(var_van <span class="op">-</span><span class="st"> </span>var_ant)<span class="op">/</span>(var_van)</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The vanilla Monte Carlo estimate is&quot;</span>,<span class="kw">round</span>(est_van,<span class="dv">3</span>),<span class="st">&quot; the estimate with antithetic variables is&quot;</span>,<span class="kw">round</span>(est_ant,<span class="dv">3</span>),<span class="st">&quot;and the true value is&quot;</span>,<span class="kw">round</span>(<span class="kw">integrate</span>(f,<span class="dt">lower =</span> <span class="dv">0</span>,<span class="dt">upper =</span> <span class="dv">1</span>)<span class="op">$</span>value,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;The vanilla Monte Carlo estimate is 0.525  the estimate with antithetic variables is 0.527 and the true value is 0.525&quot;</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The variance of vanilla MC is&quot;</span>,<span class="kw">round</span>(var_van,<span class="dv">4</span>),<span class="st">&quot;and the variance of MC with antithetic variables is&quot;</span>,<span class="kw">round</span>(var_ant,<span class="dv">4</span>),<span class="st">&quot;reducing by&quot;</span>,<span class="kw">round</span>(reduction,<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;The variance of vanilla MC is 0.061 and the variance of MC with antithetic variables is 0.0609 reducing by 0&quot;</code></pre>
<hr />
</div>
<div id="exercise-15" class="section level3">
<h3>Exercise 15</h3>
<p>Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10. <span class="math inline">\(sol.\)</span> For comparison,we use the two methods to obtain the estimates via the 3rd candidate for the importance functions. <span class="math display">\[
f_3(x) = e^{-x}/(1-e^{-1}),\ 0&lt;x&lt;1
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb19-2" title="2">k &lt;-<span class="st"> </span><span class="dv">10</span> <span class="co">#number of strata</span></a>
<a class="sourceLine" id="cb19-3" title="3">N0 &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation </span></a>
<a class="sourceLine" id="cb19-4" title="4">T =<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb19-5" title="5">estimates =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N0,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7">g =<span class="st"> </span><span class="cf">function</span>(t) { <span class="kw">exp</span>(<span class="op">-</span>t <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>t<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(t <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(t <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) }</a>
<a class="sourceLine" id="cb19-8" title="8">fg =<span class="st"> </span><span class="cf">function</span>(t) { <span class="kw">g</span>(t) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>t) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) }</a>
<a class="sourceLine" id="cb19-9" title="9">inv =<span class="st"> </span><span class="cf">function</span>(t) { <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>t <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) } <span class="co">##inverse transform method </span></a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N0){</a>
<a class="sourceLine" id="cb19-12" title="12">  estimates[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">inv</span>(<span class="kw">runif</span>(m))))</a>
<a class="sourceLine" id="cb19-13" title="13">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb19-14" title="14">    T[j] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">inv</span>(<span class="kw">runif</span>(m<span class="op">/</span>k,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k))))</a>
<a class="sourceLine" id="cb19-15" title="15">  estimates[i,<span class="dv">2</span>] =<span class="st"> </span><span class="kw">mean</span>(T) </a>
<a class="sourceLine" id="cb19-16" title="16">  }</a>
<a class="sourceLine" id="cb19-17" title="17">}</a>
<a class="sourceLine" id="cb19-18" title="18">v =<span class="st"> </span><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</a>
<a class="sourceLine" id="cb19-19" title="19"></a>
<a class="sourceLine" id="cb19-20" title="20"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimates of no-stratified and stratified are: &quot;</span>,<span class="kw">round</span>(<span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean),<span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] &quot;The estimates of no-stratified and stratified are:  0.525&quot;
## [2] &quot;The estimates of no-stratified and stratified are:  0.525&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The variances of no-stratified and stratified are: &quot;</span>,v))</a></code></pre></div>
<pre><code>## [1] &quot;The variances of no-stratified and stratified are:  8.04246992958373e-07&quot;
## [2] &quot;The variances of no-stratified and stratified are:  1.42387855183685e-08&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;This represents a&quot;</span>,<span class="dv">100</span><span class="op">*</span><span class="kw">round</span>((v[<span class="dv">1</span>]<span class="op">-</span>v[<span class="dv">2</span>])<span class="op">/</span>v[<span class="dv">1</span>],<span class="dv">2</span>),<span class="st">&quot;% reduction in variance.&quot;</span>))</a></code></pre></div>
<pre><code>## [1] &quot;This represents a 98 % reduction in variance.&quot;</code></pre>
<hr />
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercise 6.5,6.6 (page 180, textbook)</p>
<hr />
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.5" class="section level3">
<h3>Exercise 6.5</h3>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><span class="math inline">\(Sol.\)</span> First, the <span class="math inline">\(t\)</span>-interval to estimate a mean is <span class="math inline">\(\left(\overline{x}-t_{\alpha/2}\frac{s}{\sqrt{n}},\overline{x}+t_{\alpha/2}\frac{s}{\sqrt{n}}\right)\)</span>. And the confidence interval for the variance in Example 6.4 is <span class="math inline">\((0,\frac{(n-1)s^2}{\chi_{0.05}^2 (n-1)})\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3">m =<span class="st"> </span><span class="fl">5e4</span>                    <span class="co">#MCMC sample size</span></a>
<a class="sourceLine" id="cb25-4" title="4">n =<span class="st"> </span><span class="dv">20</span>                     <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb25-5" title="5"></a>
<a class="sourceLine" id="cb25-6" title="6">est1 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)            <span class="co">#MC estimate coverage probability of t-interval</span></a>
<a class="sourceLine" id="cb25-7" title="7">est2 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)            <span class="co">#MC estimate coverage probability of chi2-interval</span></a>
<a class="sourceLine" id="cb25-8" title="8"></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb25-10" title="10">  </a>
<a class="sourceLine" id="cb25-11" title="11">  X =<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)    <span class="co">#sample from chi2 </span></a>
<a class="sourceLine" id="cb25-12" title="12">  </a>
<a class="sourceLine" id="cb25-13" title="13">  est1[i] =<span class="st"> </span><span class="kw">mean</span>(X)<span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">mean</span>(X) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb25-14" title="14">  <span class="co"># the mean of the chi2 is 2</span></a>
<a class="sourceLine" id="cb25-15" title="15">  </a>
<a class="sourceLine" id="cb25-16" title="16">  est2[i] =<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">qchisq</span>(<span class="fl">0.05</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb25-17" title="17">  <span class="co"># the variance of the chi2 is 4</span></a>
<a class="sourceLine" id="cb25-18" title="18">  </a>
<a class="sourceLine" id="cb25-19" title="19">  }</a>
<a class="sourceLine" id="cb25-20" title="20"></a>
<a class="sourceLine" id="cb25-21" title="21"><span class="kw">mean</span>(est1)             </a></code></pre></div>
<pre><code>## [1] 0.94954</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">mean</span>(est2)           </a></code></pre></div>
<pre><code>## [1] 0.7845</code></pre>
<p>As we can see, the coverage probability of <span class="math inline">\(t\)</span>-interval is more close to 0.94, then it is more robust to departures from normality than the interval for variance.</p>
<hr />
</div>
<div id="exercise-6.6" class="section level3">
<h3>Exercise 6.6</h3>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1} \approx N(0,6/n)\)</span>.</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">set.seed</span>(<span class="dv">54321</span>)</a>
<a class="sourceLine" id="cb29-2" title="2">q0 =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb29-3" title="3">n=<span class="dv">500</span></a>
<a class="sourceLine" id="cb29-4" title="4">m =<span class="st"> </span><span class="fl">5e4</span></a>
<a class="sourceLine" id="cb29-5" title="5">skew =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb29-6" title="6"></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb29-8" title="8">  sam =<span class="st"> </span><span class="kw">rnorm</span>(n)          </a>
<a class="sourceLine" id="cb29-9" title="9">  skew[i] =<span class="st"> </span><span class="kw">mean</span>((sam <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(sam))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">mean</span>((sam <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(sam))<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span><span class="fl">1.5</span>           </a>
<a class="sourceLine" id="cb29-10" title="10">  }</a>
<a class="sourceLine" id="cb29-11" title="11">  </a>
<a class="sourceLine" id="cb29-12" title="12">est1_q =<span class="st"> </span><span class="kw">quantile</span>(skew, <span class="dt">probs =</span> q0)           </a>
<a class="sourceLine" id="cb29-13" title="13">  </a>
<a class="sourceLine" id="cb29-14" title="14">est2_q =<span class="st"> </span><span class="kw">qnorm</span>(q0, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n) )         </a>
<a class="sourceLine" id="cb29-15" title="15"></a>
<a class="sourceLine" id="cb29-16" title="16">std1 =<span class="st"> </span><span class="kw">sqrt</span>( q0<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q0)<span class="op">/</span>n<span class="op">/</span>( <span class="kw">dnorm</span>(est1_q, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) )<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb29-17" title="17"><span class="co"># the standard error of sample quantile estimates </span></a>
<a class="sourceLine" id="cb29-18" title="18">  </a>
<a class="sourceLine" id="cb29-19" title="19">result =<span class="st"> </span><span class="kw">cbind</span>(est2_q, est1_q, std1)</a>
<a class="sourceLine" id="cb29-20" title="20"><span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;theoretical quantile(Normal)&quot;</span>,<span class="st">&quot;sample quantile&quot;</span>,<span class="st">&quot;standard error of sample quantile(2.14)&quot;</span>)</a>
<a class="sourceLine" id="cb29-21" title="21">  </a>
<a class="sourceLine" id="cb29-22" title="22">knitr<span class="op">::</span><span class="kw">kable</span>(result)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">theoretical quantile(Normal)</th>
<th align="right">sample quantile</th>
<th align="right">standard error of sample quantile(2.14)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2.5%</td>
<td align="right">-0.2147033</td>
<td align="right">-0.2132009</td>
<td align="right">0.0127408</td>
</tr>
<tr class="even">
<td>5%</td>
<td align="right">-0.1801847</td>
<td align="right">-0.1792592</td>
<td align="right">0.0102100</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">0.1801847</td>
<td align="right">0.1777685</td>
<td align="right">0.0099860</td>
</tr>
<tr class="even">
<td>97.5%</td>
<td align="right">0.2147033</td>
<td align="right">0.2152698</td>
<td align="right">0.0132202</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 6.7, 6.A, slides page 22 (pages 180-181, Statistical Computating with R).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.7" class="section level3">
<h3>Exercise 6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\text{Beta} (\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(\text{}t(\nu)\)</span>?</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">sk =<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb30-2" title="2">  <span class="co">#sample skewness </span></a>
<a class="sourceLine" id="cb30-3" title="3">  m1 =<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb30-4" title="4">  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb30-5" title="5">  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb30-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb30-7" title="7">} </a>
<a class="sourceLine" id="cb30-8" title="8"></a>
<a class="sourceLine" id="cb30-9" title="9">alpha =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb30-10" title="10">N =<span class="st"> </span><span class="dv">5000</span>  <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb30-11" title="11">n =<span class="st"> </span><span class="dv">30</span>  <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb30-12" title="12">sl =<span class="st"> </span><span class="fl">0.05</span>  <span class="co">##significance level</span></a>
<a class="sourceLine" id="cb30-13" title="13">result1 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(alpha))</a>
<a class="sourceLine" id="cb30-14" title="14"></a>
<a class="sourceLine" id="cb30-15" title="15"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alpha)) {           </a>
<a class="sourceLine" id="cb30-16" title="16">  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sl<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))  <span class="co">##critical value for the skewness test</span></a>
<a class="sourceLine" id="cb30-17" title="17">  skvector1 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb30-18" title="18">  </a>
<a class="sourceLine" id="cb30-19" title="19">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {           </a>
<a class="sourceLine" id="cb30-20" title="20">    x =<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dt">shape1 =</span> alpha[j], <span class="dt">shape2 =</span> alpha[j]) </a>
<a class="sourceLine" id="cb30-21" title="21">    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) skvector1[i] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-22" title="22">    <span class="cf">else</span> skvector1[i] =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb30-23" title="23">  } </a>
<a class="sourceLine" id="cb30-24" title="24">  </a>
<a class="sourceLine" id="cb30-25" title="25">  result1[j] =<span class="st"> </span><span class="kw">mean</span>(skvector1) </a>
<a class="sourceLine" id="cb30-26" title="26">}</a>
<a class="sourceLine" id="cb30-27" title="27"></a>
<a class="sourceLine" id="cb30-28" title="28"><span class="kw">plot</span>(alpha, result1, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;Beta(a,a):significance level = 0.05&quot;</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">M =<span class="st"> </span><span class="kw">rbind</span>(alpha, result1)</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;alpha&quot;</span>,<span class="st">&quot;power&quot;</span>)</a>
<a class="sourceLine" id="cb31-3" title="3"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alpha)</a>
<a class="sourceLine" id="cb31-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>alpha</td>
<td align="right">0.0000</td>
<td align="right">0.5000</td>
<td align="right">1.0000</td>
<td align="right">1.5000</td>
<td align="right">2.000</td>
<td align="right">2.5000</td>
<td align="right">3.0000</td>
</tr>
<tr class="even">
<td>power</td>
<td align="right">0.0384</td>
<td align="right">0.0094</td>
<td align="right">0.0042</td>
<td align="right">0.0054</td>
<td align="right">0.006</td>
<td align="right">0.0068</td>
<td align="right">0.0068</td>
</tr>
</tbody>
</table>
<p>Comment: the power of the tests are very small, which means it is hard for us to reject the null hypothesis when the true skewness is far from normality.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">sk =<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb32-2" title="2">  <span class="co">#sample skewness </span></a>
<a class="sourceLine" id="cb32-3" title="3">  m1 =<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb32-4" title="4">  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb32-5" title="5">  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb32-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb32-7" title="7">} </a>
<a class="sourceLine" id="cb32-8" title="8"></a>
<a class="sourceLine" id="cb32-9" title="9">freedom =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-10" title="10">N =<span class="st"> </span><span class="dv">5000</span>  <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb32-11" title="11">n =<span class="st"> </span><span class="dv">30</span>  <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb32-12" title="12">sl =<span class="st"> </span><span class="fl">0.05</span>  <span class="co">##significance level</span></a>
<a class="sourceLine" id="cb32-13" title="13">result2 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(freedom))</a>
<a class="sourceLine" id="cb32-14" title="14"></a>
<a class="sourceLine" id="cb32-15" title="15"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(freedom)) {           </a>
<a class="sourceLine" id="cb32-16" title="16">  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sl<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))  <span class="co">##critical value for the skewness test</span></a>
<a class="sourceLine" id="cb32-17" title="17">  skvector2 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb32-18" title="18">  </a>
<a class="sourceLine" id="cb32-19" title="19">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {           </a>
<a class="sourceLine" id="cb32-20" title="20">    x =<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> freedom[j])  </a>
<a class="sourceLine" id="cb32-21" title="21">    <span class="cf">if</span> (<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) skvector2[i] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb32-22" title="22">    <span class="cf">else</span> skvector2[i] =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb32-23" title="23">  } </a>
<a class="sourceLine" id="cb32-24" title="24">  </a>
<a class="sourceLine" id="cb32-25" title="25">  result2[j] =<span class="st"> </span><span class="kw">mean</span>(skvector2) </a>
<a class="sourceLine" id="cb32-26" title="26">}</a>
<a class="sourceLine" id="cb32-27" title="27"></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="kw">plot</span>(freedom, result2, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;fr&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;t(fr): significance level = 0.05&quot;</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">M =<span class="st"> </span><span class="kw">rbind</span>(freedom, result2)</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;degree of fr&quot;</span>,<span class="st">&quot;power&quot;</span>)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(freedom)</a>
<a class="sourceLine" id="cb33-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>degree of fr</td>
<td align="right">1.0000</td>
<td align="right">2.0000</td>
<td align="right">3.0000</td>
<td align="right">4.0000</td>
<td align="right">5.0000</td>
<td align="right">6.0000</td>
<td align="right">7.0000</td>
<td align="right">8.0000</td>
<td align="right">9.000</td>
<td align="right">10.0000</td>
</tr>
<tr class="even">
<td>power</td>
<td align="right">0.8472</td>
<td align="right">0.6066</td>
<td align="right">0.4298</td>
<td align="right">0.3286</td>
<td align="right">0.2646</td>
<td align="right">0.2144</td>
<td align="right">0.1894</td>
<td align="right">0.1552</td>
<td align="right">0.153</td>
<td align="right">0.1354</td>
</tr>
</tbody>
</table>
<p>Comments: the power of the tests is big when <span class="math inline">\(degree\ of\ freedom(\nu)\)</span> is small and when <span class="math inline">\(degree\ of\ freedom(\nu)\)</span> becomes larger, <span class="math inline">\(\text{}t(\nu)\)</span> becomes close to the standard gaussian, with the power tending to be small.</p>
</div>
<div id="exercise-6.a" class="section level3">
<h3>Exercise 6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the <span class="math inline">\(t\)</span>-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The <span class="math inline">\(t\)</span>-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is: (i) <span class="math inline">\(\chi^2 (1)\)</span>, (ii) Uniform<span class="math inline">\((0,2)\)</span>, and (iii) Exponential(rate<span class="math inline">\(=1\)</span>). In each case, test <span class="math inline">\(H_0 : \mu = \mu_0\)</span> vs <span class="math inline">\(H_1 : \mu\neq \mu_0\)</span>, whereµ0 is the mean of <span class="math inline">\(\chi^2 (1)\)</span>, Uniform<span class="math inline">\((0,2)\)</span>, and Exponential(<span class="math inline">\(1\)</span>), respectively.</p>
<p><span class="math inline">\(Sol.\)</span> Case 1: <span class="math inline">\(\chi^2 (1)\)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb34-2" title="2">N =<span class="st"> </span><span class="dv">3000</span> <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb34-3" title="3">n =<span class="st"> </span><span class="dv">30</span> <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb34-4" title="4">result3 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(sl))</a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)){</a>
<a class="sourceLine" id="cb34-7" title="7">    </a>
<a class="sourceLine" id="cb34-8" title="8">    t1e_vector =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb34-9" title="9"></a>
<a class="sourceLine" id="cb34-10" title="10">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb34-11" title="11">      x =<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">1</span>)                                              </a>
<a class="sourceLine" id="cb34-12" title="12">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                      </a>
<a class="sourceLine" id="cb34-13" title="13">      t1e_vector[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">&gt;</span>q<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n))  <span class="co">## the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb34-14" title="14">    }</a>
<a class="sourceLine" id="cb34-15" title="15">    </a>
<a class="sourceLine" id="cb34-16" title="16">    result3[j] =<span class="st"> </span><span class="kw">mean</span>(t1e_vector)</a>
<a class="sourceLine" id="cb34-17" title="17">  }</a>
<a class="sourceLine" id="cb34-18" title="18"></a>
<a class="sourceLine" id="cb34-19" title="19">result3 =<span class="st"> </span><span class="kw">round</span>(result3,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb34-20" title="20">M =<span class="st"> </span><span class="kw">rbind</span>(sl, result3)</a>
<a class="sourceLine" id="cb34-21" title="21"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb34-22" title="22"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb34-23" title="23">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>significance level</td>
<td align="right">0.010</td>
<td align="right">0.050</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
</tr>
<tr class="even">
<td>empirical type I error rate</td>
<td align="right">0.072</td>
<td align="right">0.106</td>
<td align="right">0.139</td>
<td align="right">0.172</td>
</tr>
</tbody>
</table>
<p>Comments: type I error rate is rather different from the significance level.</p>
<p>Case 2: Uniform<span class="math inline">\((0,2)\)</span></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb35-2" title="2">N =<span class="st"> </span><span class="dv">3000</span> <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb35-3" title="3">n =<span class="st"> </span><span class="dv">30</span> <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb35-4" title="4">result4 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(sl))</a>
<a class="sourceLine" id="cb35-5" title="5"></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)){</a>
<a class="sourceLine" id="cb35-7" title="7">    </a>
<a class="sourceLine" id="cb35-8" title="8">    t1e_vector =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb35-11" title="11">      x =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">2</span>)                                               </a>
<a class="sourceLine" id="cb35-12" title="12">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                      </a>
<a class="sourceLine" id="cb35-13" title="13">      t1e_vector[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">&gt;</span>q<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n))  <span class="co">## the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb35-14" title="14">    }</a>
<a class="sourceLine" id="cb35-15" title="15">    </a>
<a class="sourceLine" id="cb35-16" title="16">    result4[j] =<span class="st"> </span><span class="kw">mean</span>(t1e_vector)</a>
<a class="sourceLine" id="cb35-17" title="17">  }</a>
<a class="sourceLine" id="cb35-18" title="18"></a>
<a class="sourceLine" id="cb35-19" title="19">result4 =<span class="st"> </span><span class="kw">round</span>(result4,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-20" title="20">M =<span class="st"> </span><span class="kw">rbind</span>(sl, result4)</a>
<a class="sourceLine" id="cb35-21" title="21"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb35-22" title="22"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb35-23" title="23">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>significance level</td>
<td align="right">0.01</td>
<td align="right">0.050</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
</tr>
<tr class="even">
<td>empirical type I error rate</td>
<td align="right">0.14</td>
<td align="right">0.247</td>
<td align="right">0.329</td>
<td align="right">0.444</td>
</tr>
</tbody>
</table>
<p>Comments: type I error rate is rather different from the significance level.</p>
<p>Case 3: Exponential(<span class="math inline">\(1\)</span>)</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb36-2" title="2">N =<span class="st"> </span><span class="dv">3000</span> <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb36-3" title="3">n =<span class="st"> </span><span class="dv">30</span> <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb36-4" title="4">result5 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(sl))</a>
<a class="sourceLine" id="cb36-5" title="5"></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)){</a>
<a class="sourceLine" id="cb36-7" title="7">    </a>
<a class="sourceLine" id="cb36-8" title="8">    t1e_vector =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb36-9" title="9"></a>
<a class="sourceLine" id="cb36-10" title="10">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb36-11" title="11">      x =<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>)                                               </a>
<a class="sourceLine" id="cb36-12" title="12">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                      </a>
<a class="sourceLine" id="cb36-13" title="13">      t1e_vector[i] =<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">&gt;</span>q<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n))  <span class="co">## the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb36-14" title="14">    }</a>
<a class="sourceLine" id="cb36-15" title="15">    </a>
<a class="sourceLine" id="cb36-16" title="16">    result5[j] =<span class="st"> </span><span class="kw">mean</span>(t1e_vector)</a>
<a class="sourceLine" id="cb36-17" title="17">  }</a>
<a class="sourceLine" id="cb36-18" title="18"></a>
<a class="sourceLine" id="cb36-19" title="19">result5 =<span class="st"> </span><span class="kw">round</span>(result5,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb36-20" title="20">M =<span class="st"> </span><span class="kw">rbind</span>(sl, result5)</a>
<a class="sourceLine" id="cb36-21" title="21"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb36-22" title="22"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb36-23" title="23">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>significance level</td>
<td align="right">0.010</td>
<td align="right">0.050</td>
<td align="right">0.100</td>
<td align="right">0.200</td>
</tr>
<tr class="even">
<td>empirical type I error rate</td>
<td align="right">0.071</td>
<td align="right">0.115</td>
<td align="right">0.161</td>
<td align="right">0.234</td>
</tr>
</tbody>
</table>
<p>Comments: type I error rate is rather different from the significance level.</p>
</div>
<div id="discussion-slides-page-22" class="section level3">
<h3>Discussion slides page 22</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<div id="q1.-what-is-the-corresponding-hypothesis-test-problem" class="section level4">
<h4>Q1. What is the corresponding hypothesis test problem?</h4>
<p>Null hypothesis： the powers (for two methods under a particular simulation setting) are same. Alternative hypothesis： the powers are different. Test the hypothesis at the significance level = 0.05.</p>
</div>
<div id="q2.-what-test-should-we-use" class="section level4">
<h4>Q2. What test should we use?</h4>
<p>Two-sample t-test. Since the power is the expectation of the method result, it is equivalent to say that we need to test the difference between two population means.</p>
</div>
<div id="q3.-what-information-is-needed-to-test-your-hypothesis" class="section level4">
<h4>Q3. What information is needed to test your hypothesis?</h4>
<p>The mean and standard deviation of both sample.</p>
<hr />
</div>
</div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercise 7.6 and Project 7.B(Statistical Computing with R, pages 212-213).</p>
<hr />
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.6" class="section level3">
<h3>Exercise 7.6</h3>
<p>Efron and Tibshirani discuss the <span class="math inline">\(scor\ (bootstrap)\)</span> test score data on 88 students who took examinations in ﬁvesubjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},\dots,x_{i5})\)</span> for the <span class="math inline">\(i\)</span>th student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\text{mec, vec})\)</span>, <span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\text{alg, ana})\)</span>, <span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\text{alg, sta})\)</span>, <span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\text{ana, sta})\)</span>.</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">#PART1: plot</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>))</a></code></pre></div>
<p>The sample correlation matrix is:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co">#PART2: sample correlation matrix</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">print</span>(<span class="kw">cor</span>(scor))</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co">#PART3: boostrap estimate</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb40-3" title="3">coreff &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb40-4" title="4">M =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-5" title="5"></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co">#standard errors of cor(mec,vec)</span></a>
<a class="sourceLine" id="cb40-7" title="7">M[<span class="dv">1</span>,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dt">statistic =</span> coreff, <span class="dt">R=</span><span class="dv">1000</span>)<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="co">#standard errors of cor(alg,ana)            </span></a>
<a class="sourceLine" id="cb40-10" title="10">M[<span class="dv">2</span>,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)], <span class="dt">statistic =</span> coreff, <span class="dt">R=</span><span class="dv">1000</span>)<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb40-11" title="11"></a>
<a class="sourceLine" id="cb40-12" title="12"></a>
<a class="sourceLine" id="cb40-13" title="13"><span class="co">#standard errors of cor(alg,sta)</span></a>
<a class="sourceLine" id="cb40-14" title="14">M[<span class="dv">3</span>,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">statistic =</span> coreff, <span class="dt">R=</span><span class="dv">1000</span>)<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb40-15" title="15"></a>
<a class="sourceLine" id="cb40-16" title="16"></a>
<a class="sourceLine" id="cb40-17" title="17"><span class="co">#standard errors of cor(ana,sta)</span></a>
<a class="sourceLine" id="cb40-18" title="18">M[<span class="dv">4</span>,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sd</span>(<span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">statistic =</span> coreff, <span class="dt">R=</span><span class="dv">1000</span>)<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb40-19" title="19"></a>
<a class="sourceLine" id="cb40-20" title="20"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;boot est of standard errors&quot;</span>)</a>
<a class="sourceLine" id="cb40-21" title="21"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cor(mec,vec)&quot;</span>,<span class="st">&quot;cor(alg,ana)&quot;</span>,<span class="st">&quot;cor(alg,sta)&quot;</span>,<span class="st">&quot;cor(ana,sta)&quot;</span>)</a>
<a class="sourceLine" id="cb40-22" title="22">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">boot est of standard errors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cor(mec,vec)</td>
<td align="right">0.0785207</td>
</tr>
<tr class="even">
<td>cor(alg,ana)</td>
<td align="right">0.0509943</td>
</tr>
<tr class="odd">
<td>cor(alg,sta)</td>
<td align="right">0.0585757</td>
</tr>
<tr class="even">
<td>cor(ana,sta)</td>
<td align="right">0.0663474</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="project-7.b" class="section level3">
<h3>Project 7.B</h3>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness <span class="math inline">\(0\)</span>) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">b.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb41-2" title="2">  m1 =<span class="st"> </span><span class="kw">mean</span>(x[i,])</a>
<a class="sourceLine" id="cb41-3" title="3">  m3 =<span class="st"> </span><span class="kw">mean</span>((x[i,] <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb41-4" title="4">  m2 =<span class="st"> </span><span class="kw">mean</span>((x[i,] <span class="op">-</span><span class="st"> </span>m1)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb41-5" title="5">  <span class="kw">return</span>(m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>) </a>
<a class="sourceLine" id="cb41-6" title="6">}</a>
<a class="sourceLine" id="cb41-7" title="7"></a>
<a class="sourceLine" id="cb41-8" title="8"></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co">#PART1: Normal</span></a>
<a class="sourceLine" id="cb41-10" title="10">N =<span class="st"> </span><span class="dv">1000</span> <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb41-11" title="11">n =<span class="st"> </span><span class="dv">30</span>   <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb41-12" title="12">R =<span class="st"> </span><span class="dv">1000</span> <span class="co">##bootstrap number</span></a>
<a class="sourceLine" id="cb41-13" title="13">cp.norm =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-14" title="14">cp.basic =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-15" title="15">cp.perc =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-16" title="16">count.norml =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-17" title="17">count.normr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-18" title="18">count.basicl =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-19" title="19">count.basicr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-20" title="20">count.percl =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-21" title="21">count.percr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-22" title="22"></a>
<a class="sourceLine" id="cb41-23" title="23"></a>
<a class="sourceLine" id="cb41-24" title="24"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb41-25" title="25">  data_x =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rnorm</span>(n))</a>
<a class="sourceLine" id="cb41-26" title="26">  obj =<span class="st"> </span><span class="kw">boot.ci</span>(<span class="kw">boot</span>(<span class="dt">data =</span> data_x, <span class="dt">statistic =</span> b.sk, <span class="dt">R =</span> R), <span class="dt">conf =</span> <span class="fl">0.95</span>, </a>
<a class="sourceLine" id="cb41-27" title="27">                <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb41-28" title="28">    </a>
<a class="sourceLine" id="cb41-29" title="29">  cp.norm[i] =<span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-30" title="30">  <span class="cf">if</span> (obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) count.norml =<span class="st"> </span>count.norml<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-31" title="31">  <span class="cf">if</span> (obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) count.normr =<span class="st"> </span>count.normr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-32" title="32">  cp.basic[i] =<span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-33" title="33">  <span class="cf">if</span> (obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) count.basicl =<span class="st"> </span>count.basicl<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-34" title="34">  <span class="cf">if</span> (obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) count.basicr =<span class="st"> </span>count.basicr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-35" title="35">  cp.perc[i] =<span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-36" title="36">  <span class="cf">if</span> (obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) count.percl =<span class="st"> </span>count.percl<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-37" title="37">  <span class="cf">if</span> (obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) count.percr =<span class="st"> </span>count.percr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-38" title="38">  <span class="co"># the skewness of a normal distribution is 0 </span></a>
<a class="sourceLine" id="cb41-39" title="39">  }</a>
<a class="sourceLine" id="cb41-40" title="40">  </a>
<a class="sourceLine" id="cb41-41" title="41">result1 =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">mean</span>(cp.norm),<span class="kw">mean</span>(cp.basic),<span class="kw">mean</span>(cp.perc)),<span class="kw">c</span>(count.norml<span class="op">/</span>N,count.basicl<span class="op">/</span>N,count.percl<span class="op">/</span>N),<span class="kw">c</span>(count.normr<span class="op">/</span>N,count.basicr<span class="op">/</span>N,count.percr<span class="op">/</span>N))</a>
<a class="sourceLine" id="cb41-42" title="42"></a>
<a class="sourceLine" id="cb41-43" title="43"><span class="co">#PART2: Chi^2(5)</span></a>
<a class="sourceLine" id="cb41-44" title="44">N =<span class="st"> </span><span class="dv">1000</span> <span class="co">##number of iterations</span></a>
<a class="sourceLine" id="cb41-45" title="45">n =<span class="st"> </span><span class="dv">30</span>   <span class="co">##sample size</span></a>
<a class="sourceLine" id="cb41-46" title="46">R =<span class="st"> </span><span class="dv">1000</span> <span class="co">##bootstrap number</span></a>
<a class="sourceLine" id="cb41-47" title="47">cp.norm =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-48" title="48">cp.basic =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-49" title="49">cp.perc =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb41-50" title="50">count.norml =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-51" title="51">count.normr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-52" title="52">count.basicl =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-53" title="53">count.basicr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-54" title="54">count.percl =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-55" title="55">count.percr =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb41-56" title="56"></a>
<a class="sourceLine" id="cb41-57" title="57"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb41-58" title="58">  data_x =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb41-59" title="59">  obj =<span class="st"> </span><span class="kw">boot.ci</span>(<span class="kw">boot</span>(<span class="dt">data =</span> data_x, <span class="dt">statistic =</span> b.sk, <span class="dt">R =</span> R), <span class="dt">conf =</span> <span class="fl">0.95</span>, </a>
<a class="sourceLine" id="cb41-60" title="60">                <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb41-61" title="61">    </a>
<a class="sourceLine" id="cb41-62" title="62">  cp.norm[i] =<span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>) <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb41-63" title="63">  <span class="cf">if</span> (obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.norml =<span class="st"> </span>count.norml<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-64" title="64">  <span class="cf">if</span> (obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.normr =<span class="st"> </span>count.normr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-65" title="65">  cp.basic[i] =<span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>) <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb41-66" title="66">  <span class="cf">if</span> (obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.basicl =<span class="st"> </span>count.basicl<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-67" title="67">  <span class="cf">if</span> (obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.basicr =<span class="st"> </span>count.basicr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-68" title="68">  cp.perc[i] =<span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>) <span class="op">&amp;</span><span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb41-69" title="69">  <span class="cf">if</span> (obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.percl =<span class="st"> </span>count.percl<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-70" title="70">  <span class="cf">if</span> (obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="fl">0.4</span>)) count.percr =<span class="st"> </span>count.percr<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb41-71" title="71">  <span class="co"># the skewness of chi^2(fd) distribution is 2*sqrt(2/fd)</span></a>
<a class="sourceLine" id="cb41-72" title="72">  }</a>
<a class="sourceLine" id="cb41-73" title="73">  </a>
<a class="sourceLine" id="cb41-74" title="74">result2 =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="kw">mean</span>(cp.norm),<span class="kw">mean</span>(cp.basic),<span class="kw">mean</span>(cp.perc)),<span class="kw">c</span>(count.norml<span class="op">/</span>N,count.basicl<span class="op">/</span>N,count.percl<span class="op">/</span>N),<span class="kw">c</span>(count.normr<span class="op">/</span>N,count.basicr<span class="op">/</span>N,count.percr<span class="op">/</span>N))</a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">M2 =<span class="st"> </span><span class="kw">rbind</span>(result1,result2)</a>
<a class="sourceLine" id="cb42-2" title="2"><span class="kw">rownames</span>(M2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;proportion of miss left&quot;</span>,<span class="st">&quot;proportion of miss right&quot;</span>,<span class="st">&quot;chi^2(5)&quot;</span>,<span class="st">&quot;proportion of miss left&quot;</span>,<span class="st">&quot;proportion of miss right&quot;</span>)</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="kw">colnames</span>(M2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;precentile&quot;</span>)</a>
<a class="sourceLine" id="cb42-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(M2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">normal</th>
<th align="right">basic</th>
<th align="right">precentile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td align="right">0.896</td>
<td align="right">0.879</td>
<td align="right">0.951</td>
</tr>
<tr class="even">
<td>proportion of miss left</td>
<td align="right">0.057</td>
<td align="right">0.067</td>
<td align="right">0.030</td>
</tr>
<tr class="odd">
<td>proportion of miss right</td>
<td align="right">0.047</td>
<td align="right">0.054</td>
<td align="right">0.019</td>
</tr>
<tr class="even">
<td>chi^2(5)</td>
<td align="right">0.722</td>
<td align="right">0.704</td>
<td align="right">0.689</td>
</tr>
<tr class="odd">
<td>proportion of miss left</td>
<td align="right">0.013</td>
<td align="right">0.026</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td>proportion of miss right</td>
<td align="right">0.265</td>
<td align="right">0.270</td>
<td align="right">0.311</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 7.8 and 7.10 (Statistical Computing with R, page 213)</p>
<hr />
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.6-1" class="section level3">
<h3>Exercise 7.6</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>. <span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">pr1 =<span class="st"> </span><span class="cf">function</span> (M){ <span class="co">##the proportion of variance explained by the ﬁrst principal component</span></a>
<a class="sourceLine" id="cb43-2" title="2">  lambda =<span class="st"> </span><span class="kw">eigen</span>(M)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb43-3" title="3">  <span class="cf">if</span> (<span class="kw">min</span>(lambda)<span class="op">&lt;=</span><span class="dv">0</span>) <span class="kw">return</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb43-4" title="4">  <span class="kw">return</span>(<span class="kw">max</span>(lambda)<span class="op">/</span><span class="kw">sum</span>(lambda))</a>
<a class="sourceLine" id="cb43-5" title="5">}</a>
<a class="sourceLine" id="cb43-6" title="6"></a>
<a class="sourceLine" id="cb43-7" title="7">jack_pr =<span class="st"> </span><span class="cf">function</span> (data){</a>
<a class="sourceLine" id="cb43-8" title="8">  n =<span class="st"> </span><span class="kw">ncol</span>(data)</a>
<a class="sourceLine" id="cb43-9" title="9">  theta.jack =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb43-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> n){</a>
<a class="sourceLine" id="cb43-11" title="11">    theta.jack[i] =<span class="st"> </span><span class="kw">pr1</span>(<span class="dt">M =</span> <span class="kw">cov</span>(data[,<span class="op">-</span>i]))</a>
<a class="sourceLine" id="cb43-12" title="12">  }</a>
<a class="sourceLine" id="cb43-13" title="13">  theta.hat =<span class="st"> </span><span class="kw">pr1</span>(<span class="dt">M =</span> <span class="kw">cov</span>(data))</a>
<a class="sourceLine" id="cb43-14" title="14">  <span class="kw">return</span>(<span class="kw">c</span>((n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat),<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb43-15" title="15">}</a>
<a class="sourceLine" id="cb43-16" title="16"></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb43-18" title="18">result =<span class="st"> </span><span class="kw">jack_pr</span>(scor)</a>
<a class="sourceLine" id="cb43-19" title="19">M =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> result,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-20" title="20"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;est of bias&quot;</span>,<span class="st">&quot;est of std&quot;</span>)</a>
<a class="sourceLine" id="cb43-21" title="21"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;value&quot;</span>)</a>
<a class="sourceLine" id="cb43-22" title="22">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">est of bias</th>
<th align="right">est of std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>value</td>
<td align="right">-1.950995</td>
<td align="right">0.5254652</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="project-7.10" class="section level3">
<h3>Project 7.10</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">attach</span>(ironslag) </a>
<a class="sourceLine" id="cb48-2" title="2"></a>
<a class="sourceLine" id="cb48-3" title="3"><span class="co"># for n-fold cross validation </span></a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co"># fit models on leave-one-out samples </span></a>
<a class="sourceLine" id="cb48-5" title="5"></a>
<a class="sourceLine" id="cb48-6" title="6">jack_coef_cv =<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb48-7" title="7">  n =<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb48-8" title="8">  e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">rep</span>(n,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb48-9" title="9"></a>
<a class="sourceLine" id="cb48-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb48-11" title="11">  y =<span class="st"> </span>magnetic[<span class="op">-</span>i] </a>
<a class="sourceLine" id="cb48-12" title="12">  x =<span class="st"> </span>chemical[<span class="op">-</span>i]</a>
<a class="sourceLine" id="cb48-13" title="13">  </a>
<a class="sourceLine" id="cb48-14" title="14">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb48-15" title="15">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] </a>
<a class="sourceLine" id="cb48-16" title="16">  e1[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb48-17" title="17">  </a>
<a class="sourceLine" id="cb48-18" title="18">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb48-19" title="19">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span>   </a>
<a class="sourceLine" id="cb48-20" title="20">  e2[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb48-21" title="21">  </a>
<a class="sourceLine" id="cb48-22" title="22">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb48-23" title="23">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] </a>
<a class="sourceLine" id="cb48-24" title="24">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb48-25" title="25">  e3[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb48-26" title="26">  </a>
<a class="sourceLine" id="cb48-27" title="27">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,<span class="dv">3</span>,<span class="dt">raw=</span>T)) </a>
<a class="sourceLine" id="cb48-28" title="28">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb48-29" title="29">  e4[i] &lt;-<span class="st"> </span>magnetic[i] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb48-30" title="30">}</a>
<a class="sourceLine" id="cb48-31" title="31">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb48-32" title="32">}</a>
<a class="sourceLine" id="cb48-33" title="33"></a>
<a class="sourceLine" id="cb48-34" title="34">result =<span class="st"> </span><span class="kw">jack_coef_cv</span>()</a></code></pre></div>
<pre><code>## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素

## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">M =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> result,<span class="dv">1</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;log&quot;</span>,<span class="st">&quot;cubic&quot;</span>)</a>
<a class="sourceLine" id="cb50-3" title="3"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;prediction error&quot;</span>)</a>
<a class="sourceLine" id="cb50-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">linear</th>
<th align="right">quadratic</th>
<th align="right">log</th>
<th align="right">cubic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>prediction error</td>
<td align="right">19.55644</td>
<td align="right">17.85248</td>
<td align="right">18.44188</td>
<td align="right">18.17756</td>
</tr>
</tbody>
</table>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">y =<span class="st"> </span>magnetic</a>
<a class="sourceLine" id="cb51-2" title="2">x =<span class="st"> </span>chemical</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) )</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 24.49262    9.14657   2.678   0.0100 **
## x           -1.39334    0.88852  -1.568   0.1232   
## I(x^2)       0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">R2_coef =<span class="st"> </span><span class="cf">function</span>(<span class="dt">data =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb53-2" title="2">  e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb53-3" title="3"></a>
<a class="sourceLine" id="cb53-4" title="4">  y =<span class="st"> </span>magnetic</a>
<a class="sourceLine" id="cb53-5" title="5">  x =<span class="st"> </span>chemical</a>
<a class="sourceLine" id="cb53-6" title="6">  </a>
<a class="sourceLine" id="cb53-7" title="7">  e1 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x))<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb53-8" title="8">  e2 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb53-9" title="9">  e3 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x))<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb53-10" title="10">  e4 &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,<span class="dv">3</span>,<span class="dt">raw=</span>T)))<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb53-11" title="11"></a>
<a class="sourceLine" id="cb53-12" title="12">  <span class="kw">return</span>(<span class="kw">c</span>(e1,e2,e3,e4))</a>
<a class="sourceLine" id="cb53-13" title="13">}</a>
<a class="sourceLine" id="cb53-14" title="14"></a>
<a class="sourceLine" id="cb53-15" title="15">result =<span class="st"> </span><span class="kw">R2_coef</span>()</a></code></pre></div>
<pre><code>## Warning in if (raw) {: 条件的长度大于一，因此只能用其第一元素</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">M =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> result,<span class="dv">1</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">colnames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;log&quot;</span>,<span class="st">&quot;cubic&quot;</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Adjusted R Square&quot;</span>)</a>
<a class="sourceLine" id="cb55-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(M)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">linear</th>
<th align="right">quadratic</th>
<th align="right">log</th>
<th align="right">cubic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Adjusted R Square</td>
<td align="right">0.5281545</td>
<td align="right">0.5768151</td>
<td align="right">0.5280556</td>
<td align="right">0.5740396</td>
</tr>
</tbody>
</table>
<p>According to the adjusted R square criterion, Model 3, the log model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">y =<span class="st"> </span>magnetic</a>
<a class="sourceLine" id="cb56-2" title="2">x =<span class="st"> </span>chemical</a>
<a class="sourceLine" id="cb56-3" title="3"><span class="kw">summary</span>(<span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x))</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(y) ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.64173 -0.09555 -0.00529  0.10021  0.43117 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.112158   0.117442  17.985  &lt; 2e-16 ***
## x           0.041608   0.005409   7.693  4.4e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1967 on 51 degrees of freedom
## Multiple R-squared:  0.5371, Adjusted R-squared:  0.5281 
## F-statistic: 59.18 on 1 and 51 DF,  p-value: 4.399e-10</code></pre>
<hr />
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercise 8.3 (Statistical Computing with R, page 243) and slides page 31.</p>
<hr />
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="exercise-8.3" class="section level3">
<h3>Exercise 8.3</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p><span class="math inline">\(Sol.\)</span> Assume the sample size of <span class="math inline">\(X\)</span> is <span class="math inline">\(m\)</span> and size of <span class="math inline">\(Y\)</span> is <span class="math inline">\(n\)</span>, and without loss of generality, assume <span class="math inline">\(m&lt;n\)</span>. Conisder <span class="math inline">\(Z = c\left(X,Y\right)\)</span> and the statistics:</p>
<p><span class="math display">\[
\hat{\theta} := maxout\{Z[1:m],Z[(m+1):2m]\}
\]</span> and then do permutation test.(See Page 177 on Statistical Computing with R for details of <span class="math inline">\(maxout\)</span>)</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">maxout =<span class="st"> </span><span class="cf">function</span>(x,y){</a>
<a class="sourceLine" id="cb58-2" title="2">  X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb58-3" title="3">  Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb58-4" title="4">  outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb58-5" title="5">  outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) </a>
<a class="sourceLine" id="cb58-6" title="6">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb58-7" title="7">}</a>
<a class="sourceLine" id="cb58-8" title="8">count5_permutation =<span class="st"> </span><span class="cf">function</span>(X,Y,N){</a>
<a class="sourceLine" id="cb58-9" title="9">  <span class="cf">if</span>(<span class="kw">length</span>(X)<span class="op">&lt;=</span><span class="kw">length</span>(Y)){</a>
<a class="sourceLine" id="cb58-10" title="10">    m =<span class="st"> </span><span class="kw">length</span>(X)</a>
<a class="sourceLine" id="cb58-11" title="11">    Z =<span class="st"> </span><span class="kw">c</span>(X,Y)</a>
<a class="sourceLine" id="cb58-12" title="12">    theta.hat =<span class="st"> </span><span class="kw">maxout</span>(X,Y)</a>
<a class="sourceLine" id="cb58-13" title="13">  }</a>
<a class="sourceLine" id="cb58-14" title="14">  <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb58-15" title="15">    m =<span class="st"> </span><span class="kw">length</span>(Y)</a>
<a class="sourceLine" id="cb58-16" title="16">    Z =<span class="st"> </span><span class="kw">c</span>(Y,X)</a>
<a class="sourceLine" id="cb58-17" title="17">    theta.hat =<span class="st"> </span><span class="kw">maxout</span>(Y,X)</a>
<a class="sourceLine" id="cb58-18" title="18">  }</a>
<a class="sourceLine" id="cb58-19" title="19">  theta.per =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb58-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb58-21" title="21">    ind =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Z),<span class="dt">size =</span> <span class="dv">2</span><span class="op">*</span>m, <span class="dt">replace =</span> F)</a>
<a class="sourceLine" id="cb58-22" title="22">    z0 =<span class="st"> </span>Z[ind]</a>
<a class="sourceLine" id="cb58-23" title="23">    theta.per[i] =<span class="st"> </span><span class="kw">maxout</span>(z0[<span class="dv">1</span><span class="op">:</span>m],z0[(m<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="dv">2</span><span class="op">*</span>m)])</a>
<a class="sourceLine" id="cb58-24" title="24">  }</a>
<a class="sourceLine" id="cb58-25" title="25">  out =<span class="st"> </span>(<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(theta.per<span class="op">&gt;=</span>theta.hat))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>N)  <span class="co">##p-value of count-five test</span></a>
<a class="sourceLine" id="cb58-26" title="26">}</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co">##exmaple 6.15</span></a>
<a class="sourceLine" id="cb59-2" title="2"></a>
<a class="sourceLine" id="cb59-3" title="3">m =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb59-4" title="4">n =<span class="st"> </span><span class="dv">600</span></a>
<a class="sourceLine" id="cb59-5" title="5">N0 =<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb59-6" title="6">result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N0)</a>
<a class="sourceLine" id="cb59-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N0){</a>
<a class="sourceLine" id="cb59-8" title="8">  result[i] =<span class="st"> </span><span class="kw">count5_permutation</span>(<span class="kw">rnorm</span>(m),<span class="kw">rnorm</span>(n),<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb59-9" title="9">}</a></code></pre></div>
<p>The p-value of testing same variances is:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">mean</span>(result) <span class="co">##p-value</span></a></code></pre></div>
<pre><code>## [1] 0.5975924</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co">##exmaple 6.15</span></a>
<a class="sourceLine" id="cb62-2" title="2"></a>
<a class="sourceLine" id="cb62-3" title="3">m =<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb62-4" title="4">n =<span class="st"> </span><span class="dv">600</span></a>
<a class="sourceLine" id="cb62-5" title="5">N0 =<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb62-6" title="6">result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N0)</a>
<a class="sourceLine" id="cb62-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N0){</a>
<a class="sourceLine" id="cb62-8" title="8">  result[i] =<span class="st"> </span><span class="kw">count5_permutation</span>(<span class="kw">rnorm</span>(m),<span class="fl">1.5</span><span class="op">*</span><span class="kw">rnorm</span>(n),<span class="fl">1e3</span>)</a>
<a class="sourceLine" id="cb62-9" title="9">}</a></code></pre></div>
<p>The p-value of testing different variances is:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">mean</span>(result) <span class="co">##p-value</span></a></code></pre></div>
<pre><code>## [1] 0.008245088</code></pre>
<hr />
</div>
<div id="slides-page-31" class="section level3">
<h3>slides page 31</h3>
<p>Power comparison (distance correlation test versus ball covariance test) <span class="math display">\[
     Model\ 1: Y=X/4+\epsilon\\
     Model\ 2: Y=X/4\times \epsilon\\
     X\sim N(0_2,I_2),\ \epsilon\sim N(0_2,I_2),\\
     X\ and\ \epsilon\ are\ independent.
\]</span> <span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb65-3" title="3"></a>
<a class="sourceLine" id="cb65-4" title="4">power_comparison =<span class="st"> </span><span class="cf">function</span>(n, N, <span class="dt">alpha =</span> <span class="fl">0.1</span>){</a>
<a class="sourceLine" id="cb65-5" title="5">  <span class="co">## n is the sample size</span></a>
<a class="sourceLine" id="cb65-6" title="6">  <span class="co">## N is the number of replication</span></a>
<a class="sourceLine" id="cb65-7" title="7">  p.dist =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-8" title="8">  p.ball =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-9" title="9">  </a>
<a class="sourceLine" id="cb65-10" title="10">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb65-11" title="11">    X =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-12" title="12">    e =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-13" title="13">    Y1 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb65-14" title="14">    Y2 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb65-15" title="15">    p.ball[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y1, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">54321</span>, <span class="dt">R =</span> <span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-16" title="16">    p.dist[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">dcor.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y1, <span class="dt">R =</span> <span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-17" title="17">    p.ball[i,<span class="dv">2</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y2, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12345</span>, <span class="dt">R =</span> <span class="dv">999</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-18" title="18">    p.dist[i,<span class="dv">2</span>] =<span class="st"> </span><span class="kw">dcor.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y2, <span class="dt">R =</span> <span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-19" title="19">  }</a>
<a class="sourceLine" id="cb65-20" title="20">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p.ball[,<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span>alpha), <span class="kw">mean</span>(p.dist[,<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span>alpha), <span class="kw">mean</span>(p.ball[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>alpha), <span class="kw">mean</span>(p.dist[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span>alpha)))</a>
<a class="sourceLine" id="cb65-21" title="21">}</a>
<a class="sourceLine" id="cb65-22" title="22"></a>
<a class="sourceLine" id="cb65-23" title="23"></a>
<a class="sourceLine" id="cb65-24" title="24">vec.n =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb65-25" title="25">matrix.power =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">ncol =</span> <span class="kw">length</span>(vec.n))</a>
<a class="sourceLine" id="cb65-26" title="26"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vec.n)){</a>
<a class="sourceLine" id="cb65-27" title="27">  matrix.power[,i] =<span class="st"> </span><span class="kw">c</span>(vec.n[i],<span class="kw">power_comparison</span>(vec.n[i], <span class="fl">2e2</span>))</a>
<a class="sourceLine" id="cb65-28" title="28">}</a>
<a class="sourceLine" id="cb65-29" title="29"><span class="co"># rownames(matrix.power) = c( &quot;sample size&quot;,&quot;dcor test1&quot;, &quot;ball test1&quot;,&quot;dcor test2&quot;, &quot;ball test2&quot; )</span></a>
<a class="sourceLine" id="cb65-30" title="30"><span class="co"># knitr::kable(matrix.power)</span></a>
<a class="sourceLine" id="cb65-31" title="31"></a>
<a class="sourceLine" id="cb65-32" title="32"><span class="kw">plot</span>(vec.n, matrix.power[<span class="dv">2</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab =</span> <span class="st">&quot;sample size&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;model1&quot;</span>)</a>
<a class="sourceLine" id="cb65-33" title="33"><span class="kw">lines</span>(vec.n, matrix.power[<span class="dv">3</span>,], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb65-34" title="34"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;dcor&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAn1BMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQtpCQttuQ2/+2ZgC2Zjq2kDq225C229u22/+2/7a2///bkDrbkGbbtmbbtpDb////AAD/tmb/25D/27b//7b//9v///8idGAcAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ6ElEQVR4nO2djXabNhiGsdPGzrrV6X5rb11Dt3Wma0Ia+/6vbfrF2JZ4AUvINu9zTj2HD4R5JgkhhMi2pJEs9Q84dygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAhQjKs+m69udmld0+moD5EovLFrT5lFGQwi3o64/ZCAS93Gezr2+yyfvtl3n2+kEt+/pTlr36RR355pNY+lELkhlm8vbRCirEX/NRCNK8kR8qoxR6wa1WoREBs+brdSXo9T+rcQhabP8TR/5emllst89zkz/E9zLLZo8y5whBIht9lsGFEfTl7eNmHILEMepPdfS2wsmNlLVaZ7oWHyIoxE3XlZeRCJrZz1r2kCYmD+L7TK4kPYmgRi0esSD9VZWupf0uBZUZBblykPpuctDSbDNuQQ110MxsM3JBx2ex3JzFRGPpm6zNRy6o3g4SVg7bQZOHsecg05L+VYU3f82zV+91Sfv2hziR/fB5ZEXszKEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQILCg7GJIJShscvGgIAAFAQYW1L1op4Y5CEBBAAoCUBCAggAUBKAgAAUBKAhAQYBIgvIsm6kn2ZeeFUYuqLh9FI7U012LAMmlJIqgzUo+IzmRs0cUnsfYxi3o5V6UrFI9cFvuzTXSL7mkMAcBItdBStXJyaWEZzEA20EACgLEFlTwLNZtd+y0T5NcPCgIEEmQnXLNUwONXlCRmfZhmbGh6KDWfualhgt1sarhxaoL5iBEYa/BxlgHeS/Q69hpRb2zPl2xoFoFM8R+U9OjiPnq3Tj7TU2fHJSBRmDQ/aaGlxoACgL0EaRmLM5bnMtC7Dc1fSrpyYNo/nlvCQbeb2r6tYNk+9jXVxh4v6np1w6Sgk4721+xIJuD8pPmRr1iQaYOKry3vMLuNzU9z2JqLuI+u2OnfZrk4kFBgF7XYrOmFQPvNxE3N+ZLjxy0mxD9BM5RkJRi/1X0LmIv91fTDjqSUqefIJmJLj8HNYqx9BAk3wxzcp9ZakFQjKVPJX3mPYrpn3oWWejk81hMQWlS21+x8A+uq/E896507YKaS1rVbe3vub5mQXnzoUvM/cJx5iCRPfAZ/uVedoaMU1BLcmFxrILUK/JgLiqyxUgFlebNVeg09jx/NUpBdvCCb2DLjs3KL/GKBdnBC2faaX9zk1pQ+xyk1hqyHaQvsFILal0HOVOJ1yddXX0mF9TyLBZov23ZXZ2nFzToftuw33exn3SvK3NvaiFWVAw4kPyoY+dA0NOO/chxK02cf47Gz/W+L9ZYRQ84kPy44yu5IPMwakMlNNQwYHe3YGpBm5VOouHe/CADyVt2szcJ+nme6RwuOyiWoQS9vNNZp6GhGD0HNfYotxekrqflO6NnukSEzUFNDcWkA8nbC1Ltuela/S+XBS5UHaSOvrmhGHEgeccbNagO0jWqemd9qCKG+1O7JNeJVjdrWgu6ezCfhTiSv8PloCD0SK7fnawWOUh9CVjEgtA9ubZ+WrekTR10+6hON2WwIhaGbsm1vg/aJWl1FpNedOYRp5MLFdRFTpekdTtIn3DEtXc+ebhMQV39jOpqvlPR6pZ08NSGFdRmYErPpGOlNpggNWonTtJRUxtEUO9cg5OOnlpcQacUKZD0UKmF2a2jzXZykTraR8jEEuegYLnmOOnqL9AnXYK7D2dSxOIlnd3soCBH0hQEkm4SJC8xPkhB4osadllmqg/25d2HqidnzIJyIaGUd0B1d+vCXNHPzPCvjj/0+gTp/iB1jar7hXVXerlb0OmHXp8gM9ms6TDbWmPis35JP2JBRSXoTtfTWtBBn8eIBSXNQS3vzT89iX+dEm5B+y5X1VnmrINiC+p0b/4psKjWv7RQXa7mLLZZzWpnsciC+t1ZDSTqqf0v9baDYgs67d58T1FPZrtLuFgNc2/+aXfQ1cG7VjuMXYCgaPfmD4U5pV2CoKSTvF2EoKGTi5c0BYVKreduE8xIflmCDlOJN5B8t480qbGIDbrb0QtKOSP5JQhKOiP5BQhqc6lxMcQQ1OJitV2iIH5a+NTNT1i9RQ5ql+i1Cmpxsdou0asVhC9W2yV6vYICJUpBp8UpiIJOi1PQ6AVdExQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQWtDzd+p2R+mcDU3dd1z444Vd6g5v7eQ97rDuD55543KOtllj6i4CCzKzLctnbY6ft9ms5NBT+SPdcTlkRC11h2W6qjfcE7YDxz3xUmwqx7r6U3cSVlCp70rr+0P54fzmZgTzdO2Oq3HNctiuZ3Pzijhv2N6rc8f1Uu/OvQQVVGYL9SsrE86V7Bh4Z1wK8oaL29+FIF+4MMfsjlf5q/HHHRO6DtKC1I/x3H3Np+uGuBz87QuL5bIO8oXz73UN546X03/vG8JeogjSJdxdzuU9R2+8VIfgCcuyIQV5wvppsNyXeiELvxp33/DjHAwtqLR1tCe+Wd0+esL29XCNRyj27xE0eWgKexm4iOl71k25vHqO6TCsljYVMb3WfOmO60rHG/YSR5C3lq2/NcBdT8pDcIYLM27FE7ab33lOAdqIN+wliiDfmdQOfnDHzdxajSfi3H+aB5vrsTvNqbuIIsjTFtOTZ2298ero/U25vKGhqI45925e4NRdxBG0u2ioYwqJeVDJ8RPNzJm+8NZeanjCYPPSXud4U3fBi1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCHD2go7e6wSWh+ZiBQ0FBQESClJvJ1fzz+v/Ps9/k+NQn9Xr057v/pzvpvAt7MiV3WZyuR5Ps9iPByadIDUiTE71bN8Xq969pwajFtO10LC0Lyg00cXeZjZnybF09Xho0gmywyir98WqQzQfy+pVjmou+sVu/WozLUi/yLAWD006QeaxDoV6X2z12s/dQE49z7oeL2emqLebaUFy1PB2Lx6ahHWQevZHVzDqfbH7gu7MaGYpyI5vrW+mBanRz/vxwCQ+i+W198X6BR0P9zQz+OuC2H5EZg8SC5KHb98Xe1DE1GBdUwd53iCvCljklkDCSto8GVa9L/ZAkHmdrD2LyVxT36xavt3uxUOTMAeV9SHB9bKmBZnXyVbtIFulm83Ecjtx6nIvHphzbUlHOid1h4IAFAQ4V0FnAwUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A+u6sCMMPTM5QAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">plot</span>(vec.n, matrix.power[<span class="dv">4</span>,], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">xlab =</span> <span class="st">&quot;sample size&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;model2&quot;</span>)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">lines</span>(vec.n, matrix.power[<span class="dv">5</span>,], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;dcor&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
</div>
</div>
<div id="hw11" class="section level1">
<h1>HW11</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercises 11.1 and 11.5 (Statistical Computing with R, pages 353-354) and Assignment-12-06.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="exercise-11.1" class="section level3">
<h3>Exercise 11.1</h3>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically <span class="math inline">\(\log(\exp x) = \exp(\log x)=x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See <span class="math inline">\(all.equal.\)</span>)</p>
<p><span class="math inline">\(Sol.\)</span> We use the function <span class="math inline">\(identical\)</span> to test the exact equality and <span class="math inline">\(all.equal\)</span> to test the near equality.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">v =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb67-2" title="2">M =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(v))</a>
<a class="sourceLine" id="cb67-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(v)){</a>
<a class="sourceLine" id="cb67-4" title="4">  M[<span class="dv">1</span>,i] =<span class="st"> </span><span class="kw">identical</span>(<span class="kw">log</span>(<span class="kw">exp</span>(v[i])),<span class="kw">exp</span>(<span class="kw">log</span>(v[i])))</a>
<a class="sourceLine" id="cb67-5" title="5">  M[<span class="dv">2</span>,i] =<span class="st"> </span><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(v[i])),<span class="kw">exp</span>(<span class="kw">log</span>(v[i]))))</a>
<a class="sourceLine" id="cb67-6" title="6">}</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.1</th>
<th align="right">1</th>
<th align="right">10</th>
<th align="right">100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>identical</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>all.equal</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Here, “1” means True and “0” means False.</p>
<hr />
</div>
<div id="exercise-11.5" class="section level3">
<h3>Exercise 11.5</h3>
<p>Write a function to solve the equation: <span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div id="ex11.4" class="section level4">
<h4>Ex11.4</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">func_S =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb68-2" title="2">  b =<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="dt">q =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df =</span> k)</a>
<a class="sourceLine" id="cb68-3" title="3">  <span class="kw">return</span>(b)</a>
<a class="sourceLine" id="cb68-4" title="4">}</a>
<a class="sourceLine" id="cb68-5" title="5">vec_k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">50</span><span class="op">:</span><span class="dv">55</span>)</a>
<a class="sourceLine" id="cb68-6" title="6">result2 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(vec_k))</a>
<a class="sourceLine" id="cb68-7" title="7"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vec_k)){</a>
<a class="sourceLine" id="cb68-8" title="8">  result2[i] =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(y){<span class="kw">func_S</span>(<span class="dt">a=</span>y,<span class="dt">k=</span>vec_k[i])<span class="op">-</span><span class="kw">func_S</span>(<span class="dt">a=</span>y,<span class="dt">k=</span>vec_k[i]<span class="op">-</span><span class="dv">1</span>)},<span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">min</span>(<span class="dv">2</span>,<span class="kw">sqrt</span>(vec_k[i]))))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb68-9" title="9">}</a></code></pre></div>
</div>
<div id="ex11.5" class="section level4">
<h4>Ex11.5</h4>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">func_intel =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb69-2" title="2">  f =<span class="st"> </span><span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-3" title="3">  b =<span class="st"> </span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(k)<span class="op">*</span><span class="kw">integrate</span>(f,<span class="dt">lower =</span> <span class="dv">0</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb69-4" title="4">  <span class="kw">return</span>(b)</a>
<a class="sourceLine" id="cb69-5" title="5">}</a>
<a class="sourceLine" id="cb69-6" title="6"></a>
<a class="sourceLine" id="cb69-7" title="7">vec_k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">50</span><span class="op">:</span><span class="dv">55</span>)</a>
<a class="sourceLine" id="cb69-8" title="8">result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(vec_k))</a>
<a class="sourceLine" id="cb69-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vec_k) ){</a>
<a class="sourceLine" id="cb69-10" title="10">  result[i] =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(y) {<span class="kw">func_intel</span>(<span class="dt">a =</span> y,<span class="dt">k =</span> vec_k[i])<span class="op">-</span><span class="kw">func_intel</span>(<span class="dt">a =</span> y,<span class="dt">k =</span> vec_k[i]<span class="op">-</span><span class="dv">1</span>)},<span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">min</span>(<span class="dv">2</span>,<span class="kw">sqrt</span>(vec_k[i])<span class="op">-</span><span class="fl">1e-4</span>)))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb69-11" title="11">}</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
<th align="right">50</th>
<th align="right">51</th>
<th align="right">52</th>
<th align="right">53</th>
<th align="right">54</th>
<th align="right">55</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ex5</td>
<td align="right">1.533556</td>
<td align="right">1.562744</td>
<td align="right">1.58443</td>
<td align="right">1.601185</td>
<td align="right">1.614521</td>
<td align="right">1.62539</td>
<td align="right">1.709342</td>
<td align="right">1.70978</td>
<td align="right">1.710202</td>
<td align="right">1.710608</td>
<td align="right">1.710999</td>
<td align="right">1.711376</td>
</tr>
<tr class="even">
<td>Ex4</td>
<td align="right">1.533556</td>
<td align="right">1.562744</td>
<td align="right">1.58443</td>
<td align="right">1.601185</td>
<td align="right">1.614521</td>
<td align="right">1.62539</td>
<td align="right">1.709342</td>
<td align="right">1.70978</td>
<td align="right">1.710202</td>
<td align="right">1.710608</td>
<td align="right">1.710999</td>
<td align="right">1.711376</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
<div id="assignment-1" class="section level3">
<h3>Assignment</h3>
<p>A-B-O blood type problem</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">E_step =<span class="st"> </span><span class="cf">function</span>(para,p0,q0,<span class="dt">nA=</span><span class="dv">28</span>,<span class="dt">nB=</span><span class="dv">24</span>,<span class="dt">nO=</span><span class="dv">41</span>,<span class="dt">nAB=</span><span class="dv">70</span>){</a>
<a class="sourceLine" id="cb70-2" title="2">  p =<span class="st"> </span>para[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb70-3" title="3">  q =<span class="st"> </span>para[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb70-4" title="4">  b =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span>nA<span class="op">*</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>q0<span class="op">-</span>p0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">/</span>p)<span class="op">+</span>nB<span class="op">*</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>p0<span class="op">-</span>q0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">/</span>q)</a>
<a class="sourceLine" id="cb70-5" title="5">  <span class="kw">return</span>(b)</a>
<a class="sourceLine" id="cb70-6" title="6">}</a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8"><span class="co">##M_step</span></a>
<a class="sourceLine" id="cb70-9" title="9">N =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb70-10" title="10">p0 =<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb70-11" title="11">q0 =<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb70-12" title="12">p_rec =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb70-13" title="13">q_rec =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb70-14" title="14">loglike =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb70-15" title="15"></a>
<a class="sourceLine" id="cb70-16" title="16"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb70-17" title="17">  obj =<span class="st"> </span><span class="cf">function</span>(y) <span class="op">-</span><span class="kw">E_step</span>(<span class="dt">para =</span> y, p0,q0)</a>
<a class="sourceLine" id="cb70-18" title="18">  itr =<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>),<span class="dt">fn =</span> obj)</a>
<a class="sourceLine" id="cb70-19" title="19">  p0 =<span class="st"> </span>itr<span class="op">$</span>par[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb70-20" title="20">  q0 =<span class="st"> </span>itr<span class="op">$</span>par[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb70-21" title="21">  p_rec[i] =<span class="st"> </span>itr<span class="op">$</span>par[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb70-22" title="22">  q_rec[i] =<span class="st"> </span>itr<span class="op">$</span>par[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb70-23" title="23">  loglike[i] =<span class="st"> </span>itr<span class="op">$</span>value</a>
<a class="sourceLine" id="cb70-24" title="24">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">p</th>
<th align="right">q</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MLE</td>
<td align="right">0.327</td>
<td align="right">0.31</td>
</tr>
</tbody>
</table>
<hr />
</div>
</div>
</div>
<div id="hw12" class="section level1">
<h1>HW12</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercises 3, 4, 5 (page 204, Advanced R), Excecises 3 and 7 (page 214, Advanced R)</p>
<hr />
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="exercise-3" class="section level3">
<h3>Exercise 3</h3>
<p>Use both for loops and <span class="math inline">\(lapply()\)</span> to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>( </a>
<a class="sourceLine" id="cb71-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp, </a>
<a class="sourceLine" id="cb71-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp), </a>
<a class="sourceLine" id="cb71-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt, </a>
<a class="sourceLine" id="cb71-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt ) </a></code></pre></div>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co">## for loop</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)){</a>
<a class="sourceLine" id="cb72-3" title="3">  result =<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb72-4" title="4">  <span class="kw">print</span>(result)</a>
<a class="sourceLine" id="cb72-5" title="5">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co">## lapply</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="kw">lm</span>(f, <span class="dt">data =</span> mtcars))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<hr />
</div>
<div id="exercise-4" class="section level3">
<h3>Exercise 4</h3>
<p>Fit the model <span class="math inline">\(mpg ~ disp\)</span> to each of the bootstrap replicates of mtcars in the list below by using a for loop and <span class="math inline">\(lapply()\)</span>. Can you do it without an anonymous function?</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb76-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb76-3" title="3">  mtcars[rows, ] }</a>
<a class="sourceLine" id="cb76-4" title="4">  ) </a></code></pre></div>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co">## for loop </span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(bootstraps)){</a>
<a class="sourceLine" id="cb77-3" title="3">  <span class="kw">print</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span> bootstraps[[i]]))</a>
<a class="sourceLine" id="cb77-4" title="4">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.11631     -0.04339  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.33483     -0.04002  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.97149     -0.03888  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.93157     -0.04571  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.94140     -0.03727  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    25.98881     -0.02653  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.06475     -0.04443  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.33743     -0.04623  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.00751     -0.03425  
## 
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.27849     -0.04053</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="co">## lapply</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="kw">lapply</span>(bootstraps, <span class="cf">function</span>(data) <span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp,<span class="dt">data =</span> data))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.11631     -0.04339  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.33483     -0.04002  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.97149     -0.03888  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.93157     -0.04571  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.94140     -0.03727  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    25.98881     -0.02653  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.06475     -0.04443  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.33743     -0.04623  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.00751     -0.03425  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.27849     -0.04053</code></pre>
<hr />
</div>
<div id="exercise-5" class="section level3">
<h3>Exercise 5</h3>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a></code></pre></div>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="kw">rsq</span>(<span class="kw">lm</span>(f,<span class="dt">data =</span> mtcars)))</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<hr />
</div>
<div id="excecises-3" class="section level3">
<h3>Excecises 3</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use <span class="math inline">\(sapply()\)</span> and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>( </a>
<a class="sourceLine" id="cb84-2" title="2">  <span class="dv">100</span>, </a>
<a class="sourceLine" id="cb84-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), </a>
<a class="sourceLine" id="cb84-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span> ) </a></code></pre></div>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(item) item<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##   [1] 0.6940478968 0.5041432637 0.1751995345 0.7987696489 0.6704787577
##   [6] 0.6405120297 0.6788151717 0.2735083577 0.3487258932 0.4304316682
##  [11] 0.5896128868 0.2487458328 0.4470869774 0.8615229235 0.7949524252
##  [16] 0.0005279039 0.2349254621 0.7664074490 0.3926233859 0.9414418594
##  [21] 0.1893265979 0.7914990051 0.1265862550 0.3261639074 0.9923444721
##  [26] 0.0541226535 0.6744872657 0.9426565355 0.0039573439 0.7347726726
##  [31] 0.5322451333 0.7774285259 0.7263259039 0.8457188770 0.6155632219
##  [36] 0.9170055770 0.5493588756 0.9381201248 0.0595372457 0.9021463905
##  [41] 0.9551187965 0.2831238022 0.9436304222 0.3991497740 0.4055306864
##  [46] 0.0447751931 0.6223091225 0.1593558022 0.1302395138 0.8860999883
##  [51] 0.9678723949 0.9723333342 0.1307017392 0.4764909164 0.1671372329
##  [56] 0.9704297377 0.8044272654 0.6530909788 0.1647655943 0.7886627175
##  [61] 0.1975334246 0.2598014358 0.7646340441 0.9364656478 0.8306810148
##  [66] 0.7426431369 0.6713200905 0.8982430430 0.2621961827 0.3190566834
##  [71] 0.7696910302 0.7767086091 0.2449768049 0.9888582466 0.6598863239
##  [76] 0.4495653001 0.2157006170 0.1748938993 0.8906362035 0.2827493446
##  [81] 0.7746026700 0.2096556668 0.1348277127 0.3447263045 0.9805340955
##  [86] 0.9497429010 0.1670263418 0.8255782425 0.7269016316 0.4893665403
##  [91] 0.4278661568 0.0041564561 0.9607850790 0.4433538300 0.2887211779
##  [96] 0.8543127423 0.5026981551 0.0289637024 0.6159610733 0.2058301610</code></pre>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
